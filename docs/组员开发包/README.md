# ç³–å°¿ç—…è§†ç½‘è†œç—…å˜å›¾åƒåˆ†ç±» - ç»„å‘˜å¼€å‘åŒ…

## ğŸ“¦ æœ¬å¼€å‘åŒ…åŒ…å«

```
ç»„å‘˜å¼€å‘åŒ…/
â”œâ”€â”€ README.md                    # æœ¬è¯´æ˜æ–‡ä»¶
â”œâ”€â”€ å›¢é˜Ÿä»»åŠ¡è¯´æ˜.md              # è¯¦ç»†ä»»åŠ¡è¯´æ˜ï¼ˆå¿…è¯»ï¼ï¼‰
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ config.py               # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ preprocessing/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ augmentation/
â”‚           â”œâ”€â”€ __init__.py
â”‚           â”œâ”€â”€ base.py         # åŸºç±»ï¼ˆä¸éœ€è¦ä¿®æ”¹ï¼‰
â”‚           â”œâ”€â”€ geometric.py    # ã€ç»„å‘˜Aã€‘éœ€è¦å®Œæˆ
â”‚           â”œâ”€â”€ color.py        # ã€ç»„å‘˜Bã€‘éœ€è¦å®Œæˆ
â”‚           â””â”€â”€ advanced.py     # ã€ç»„å‘˜Cã€‘éœ€è¦å®Œæˆ
â””â”€â”€ output/
    â””â”€â”€ preprocessing/
        â”œâ”€â”€ train.csv           # è®­ç»ƒé›†åˆ’åˆ†ç»“æœ
        â”œâ”€â”€ val.csv             # éªŒè¯é›†åˆ’åˆ†ç»“æœ
        â”œâ”€â”€ test.csv            # æµ‹è¯•é›†åˆ’åˆ†ç»“æœ
        â”œâ”€â”€ class_weights.json  # ç±»åˆ«æƒé‡
        â””â”€â”€ *.png               # å¯è§†åŒ–å›¾è¡¨
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¬¬ä¸€æ­¥ï¼šä¸‹è½½æ•°æ®é›†

æ•°æ®é›†éœ€è¦è‡ªå·±ä¸‹è½½ï¼Œæ”¾åˆ° `data/data2/` ç›®å½•ä¸‹ï¼Œç»“æ„å¦‚ä¸‹ï¼š
```
data/
â””â”€â”€ data2/
    â”œâ”€â”€ 0/    # æ— ç—…å˜å›¾ç‰‡
    â”œâ”€â”€ 1/    # è½»åº¦ç—…å˜å›¾ç‰‡
    â”œâ”€â”€ 2/    # ä¸­åº¦ç—…å˜å›¾ç‰‡
    â”œâ”€â”€ 3/    # é‡åº¦ç—…å˜å›¾ç‰‡
    â””â”€â”€ 4/    # å¢æ®–æ€§ç—…å˜å›¾ç‰‡
```

### ç¬¬äºŒæ­¥ï¼šåˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…ä¾èµ–

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ (Windows)
.\venv\Scripts\activate

# å®‰è£…ä¾èµ–
pip install numpy opencv-python -i https://pypi.tuna.tsinghua.edu.cn/simple
```

### ç¬¬ä¸‰æ­¥ï¼šå®Œæˆä½ çš„ä»»åŠ¡

æ ¹æ®ä½ çš„åˆ†å·¥ï¼Œæ‰“å¼€å¯¹åº”çš„æ–‡ä»¶ï¼š
- **ç»„å‘˜A**: `src/preprocessing/augmentation/geometric.py`
- **ç»„å‘˜B**: `src/preprocessing/augmentation/color.py`
- **ç»„å‘˜C**: `src/preprocessing/augmentation/advanced.py`

è¯¦ç»†å®ç°æ­¥éª¤è¯·çœ‹ **`å›¢é˜Ÿä»»åŠ¡è¯´æ˜.md`**

### ç¬¬å››æ­¥ï¼šæµ‹è¯•ä½ çš„ä»£ç 

```bash
# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒåè¿è¡Œ
python src/preprocessing/augmentation/geometric.py   # ç»„å‘˜A
python src/preprocessing/augmentation/color.py       # ç»„å‘˜B
python src/preprocessing/augmentation/advanced.py    # ç»„å‘˜C
```

---

## ğŸ“Š å…³äºæ•°æ®é›†åˆ’åˆ†ï¼ˆå·²å®Œæˆï¼‰

æˆ‘å·²ç»å®Œæˆäº†æ•°æ®é›†çš„åˆ’åˆ†å’Œç±»åˆ«å¹³è¡¡å¤„ç†ï¼Œç»“æœä¿å­˜åœ¨ `output/preprocessing/` ç›®å½•ä¸‹ã€‚

### åˆ’åˆ†ç»“æœ

| æ•°æ®é›† | æ ·æœ¬æ•° | ç”¨é€” |
|--------|--------|------|
| train.csv | 24,588 | è®­ç»ƒæ¨¡å‹ |
| val.csv | 5,269 | éªŒè¯è°ƒå‚ |
| test.csv | 5,269 | æœ€ç»ˆæµ‹è¯• |

### CSV æ–‡ä»¶æ ¼å¼

```csv
filepath,filename,label,label_name,label_name_cn,split
D:\ml\data\data2\0\10_left.jpeg,10_left.jpeg,0,No_DR,æ— ç—…å˜,train
D:\ml\data\data2\1\100_left.jpeg,100_left.jpeg,1,Mild,è½»åº¦,train
...
```

**é‡è¦å­—æ®µè¯´æ˜**ï¼š
- `filepath`: å›¾ç‰‡çš„å®Œæ•´è·¯å¾„
- `label`: ç±»åˆ«æ ‡ç­¾ (0-4)
- `split`: æ•°æ®é›†åˆ’åˆ† (train/val/test)

### ç±»åˆ«æƒé‡

`class_weights.json` æ–‡ä»¶å†…å®¹ï¼š
```json
{
  "0": 0.2722,
  "1": 2.8758,
  "2": 1.3276,
  "3": 8.0484,
  "4": 9.9145
}
```

è¿™äº›æƒé‡åœ¨åç»­æ¨¡å‹è®­ç»ƒæ—¶ä¼šç”¨åˆ°ï¼Œç”¨äºå¤„ç†ç±»åˆ«ä¸å‡è¡¡é—®é¢˜ã€‚

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ä¸è¦ä¿®æ”¹** `base.py` æ–‡ä»¶
2. **ä¸è¦ä¿®æ”¹** `output/preprocessing/` ä¸‹çš„æ–‡ä»¶
3. ä½ åªéœ€è¦å®ç°è‡ªå·±è´Ÿè´£çš„é‚£ä¸ªæ–‡ä»¶ä¸­çš„æ–¹æ³•
4. æµ‹è¯•æ—¶å¯ä»¥ç”¨ `data/data2/` ä¸‹çš„ä»»æ„å›¾ç‰‡

---

## â“ æœ‰é—®é¢˜ï¼Ÿ

1. å…ˆçœ‹ `å›¢é˜Ÿä»»åŠ¡è¯´æ˜.md` ä¸­çš„å¸¸è§é—®é¢˜
2. è¿˜æœ‰é—®é¢˜å°±åœ¨ç¾¤é‡Œé—®

---

## ğŸ“… æäº¤è¦æ±‚

å®Œæˆåè¯·æäº¤ï¼š
1. ä½ ä¿®æ”¹åçš„ `.py` æ–‡ä»¶
2. æµ‹è¯•è¿è¡Œçš„æˆªå›¾
